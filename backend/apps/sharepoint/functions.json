[
    {
        "name": "SHAREPOINT__SEARCH_FOR_SITES",
        "description": "Search across a SharePoint tenant for sites that match keywords provided.",
        "tags": ["sites"],
        "visibility": "public",
        "active": true,
        "protocol": "rest",
        "protocol_data": {
            "method": "GET",
            "path": "/sites?search={query}",
            "server_url": "https://graph.microsoft.com/v1.0"
        },
        "parameters": {
          "type": "object",
          "properties": {
            "path": {
              "type": "object",
              "description": "the http path parameters",
              "properties": {
                "query": {
                  "type": "string",
                  "description": "The search filter is a free text search that uses multiple properties when retrieving the search results"
                }
              },
              "required": ["query"],
              "visible":  ["query"],
              "additionalProperties": false
            }
          },
          "required": ["path"],
          "visible":  ["path"],
          "additionalProperties": false
        }
    },
    {
        "name": "SHAREPOINT__GET_ROOT_SITE",
        "description": "Get the root site of a SharePoint tenant.",
        "tags": ["sites"],
        "visibility": "public",
        "active": true,
        "protocol": "rest",
        "protocol_data": {
            "method": "GET",
            "path": "/sites/root",
            "server_url": "https://graph.microsoft.com/v1.0"
        },
        "parameters": {
            "type": "object",
            "properties": {},
            "required": [],
            "visible": [],
            "additionalProperties": false
        }
    },
    {
        "name": "SHAREPOINT__GET_SITE_BY_ID",
        "description": "Get a site by its ID.",
        "tags": ["sites"],
        "visibility": "public",
        "active": true,
        "protocol": "rest",
        "protocol_data": {
            "method": "GET",
            "path": "/sites/{site_id}",
            "server_url": "https://graph.microsoft.com/v1.0"
        },
        "parameters": {
            "type": "object",
            "properties": {
                "path": {
                    "type": "object",
                    "description": "the http path parameters",
                    "properties": {
                        "site_id": {
                            "type": "string",
                            "description": "The ID of the site to get. e.g., 'contoso.sharepoint.com,2C712604-1370-44E7-A1F5-426573FDA80A,2D2244C3-251A-49EA-93A8-39E1C3A060FE'"
                        }
                    },
                    "required": ["site_id"],
                    "visible": ["site_id"],
                    "additionalProperties": false
                }
            },
            "required": ["path"],
            "visible": ["path"],
            "additionalProperties": false
        }
    },
    {
        "name": "SHAREPOINT__GET_SITE_BY_PATH",
        "description": "retrieve a site based on server-relative URL path. Site collection hostname and Site path, relative to server hostname.",
        "tags": ["sites"],
        "visibility": "public",
        "active": true,
        "protocol": "rest",
        "protocol_data": {
            "method": "GET",
            "path": "/sites/{hostname}:/{relative_path}",
            "server_url": "https://graph.microsoft.com/v1.0"
        },
        "parameters": {
            "type": "object",
            "properties": {
                "path": {
                    "type": "object",
                    "description": "the http path parameters",
                    "properties": {
                        "hostname": {
                            "type": "string",
                            "description": "The hostname of the site to get. e.g., 'xxx.sharepoint.com'"
                        },
                        "relative_path": {
                            "type": "string",
                            "description": "The relative path of the site to get. e.g., '/sites/mySite'"
                        }
                    },
                    "required": ["hostname", "relative_path"],
                    "visible": ["hostname", "relative_path"],
                    "additionalProperties": false
                }
            },
            "required": ["path"],
            "visible": ["path"],
            "additionalProperties": false
        }
    },
    {
        "name": "SHAREPOINT__LIST_SUBSITES_FOR_A_SITE",
        "description": "List all subsites for a site.",
        "tags": ["sites"],
        "visibility": "public",
        "active": true,
        "protocol": "rest",
        "protocol_data": {
            "method": "GET",
            "path": "/sites/{site_id}/sites",
            "server_url": "https://graph.microsoft.com/v1.0"
        },
        "parameters": {
            "type": "object",
            "properties": {
                "path": {
                    "type": "object",
                    "description": "the http path parameters",
                    "properties": {
                        "site_id": {
                            "type": "string",
                            "description": "The ID of the site to list subsites for. e.g., 'contoso.sharepoint.com,2C712604-1370-44E7-A1F5-426573FDA80A,2D2244C3-251A-49EA-93A8-39E1C3A060FE'"
                        }
                    },
                    "required": ["site_id"],
                    "visible": ["site_id"],
                    "additionalProperties": false
                }
            },
            "required": ["path"],
            "visible": ["path"],
            "additionalProperties": false
        }
    }
]
